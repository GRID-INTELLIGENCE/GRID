# GRID Mothership Environment Configuration
# Copy this file to .env and update all values for your environment
# =============================================================================

# =============================================================================
# CORE MOTHERSHIP SETTINGS
# =============================================================================
MOTHERSHIP_SECRET_KEY=replace-with-a-secure-random-string-at-least-32-chars

# =============================================================================
# SAFETY ENFORCEMENT PIPELINE (Required)
# =============================================================================

# Database - SQLite for dev, PostgreSQL for production
DATABASE_URL=sqlite+aiosqlite:///E:/Projects/GRID/data/safety.db
# DATABASE_URL=postgresql+asyncpg://user:password@localhost:5432/grid_mothership

# Redis - WSL2 IP (get from: wsl hostname -I)
REDIS_URL=redis://192.168.128.109:6379

# Authentication
SAFETY_JWT_SECRET=dev-secret-key-minimum-32-characters-change-in-production
SAFETY_API_KEYS=test-key-1:verified,test-key-2:user

# Model API (Ollama default). For external OpenAI-compatible API:
# MODEL_API_URL=https://api.openai.com/v1/chat/completions
# MODEL_API_KEY=sk-...
MODEL_API_URL=http://localhost:11434/v1/completions
MODEL_NAME=llama3.2

# Sandbox Settings
SAFETY_MAX_TOKENS=4096
SAFETY_MODEL_TIMEOUT=30.0
SAFETY_MODEL_MAX_RPS=10.0

# Detector Settings
SAFETY_EMBEDDING_MODEL=all-MiniLM-L6-v2
SAFETY_ML_FLAG_THRESHOLD=0.65

# Escalation
SAFETY_AUTO_SUSPEND_SEVERITY=high
SAFETY_MISUSE_WINDOW=3600
SAFETY_MISUSE_THRESHOLD=5

# Notifications (optional)
SLACK_WEBHOOK=
PAGERDUTY_ROUTING_KEY=
SENTRY_DSN=

# Observability
SAFETY_ENV=development
SAFETY_LOG_JSON=false
SAFETY_LOG_LEVEL=INFO
SAFETY_LOG_DIR=E:/Projects/GRID/logs

# Worker Settings
SAFETY_CONSUMER_NAME=worker-default
SAFETY_BATCH_SIZE=5
SAFETY_BLOCK_MS=5000

# =============================================================================
# NOTES
# =============================================================================
# WSL2 Redis Quick Start:
#   wsl -d Ubuntu
#   sudo apt update && sudo apt install redis-server
#   sudo sed -i 's/bind 127.0.0.1 ::1/bind 0.0.0.0 ::1/' /etc/redis/redis.conf
#   sudo sed -i 's/protected-mode yes/protected-mode no/' /etc/redis/redis.conf
#   sudo service redis-server start
#   redis-cli ping  # Should return PONG
#
# Deployment:
#   1. Start Redis in WSL2
#   2. .\activate.ps1
#   3. python init_db.py
#   4. Terminal 1: .\start_api.ps1
#   5. Terminal 2: .\start_worker.ps1
#   6. Terminal 3: .\test_safety.ps1
# =============================================================================
# RAG EXTERNAL PROVIDERS (optional)
# =============================================================================
# Use external LLM/embeddings for RAG (src/tools/rag). Set RAG_LLM_MODE=external
# and one of RAG_LLM_PROVIDER=openai|anthropic|openai_compatible.
# RAG_LLM_PROVIDER=openai
# RAG_LLM_MODEL=gpt-4o-mini
# OPENAI_API_KEY=sk-...
# OPENAI_BASE_URL=   # optional: proxy or LiteLLM endpoint
# ANTHROPIC_API_KEY= # when RAG_LLM_PROVIDER=anthropic
# RAG_EMBEDDING_PROVIDER=openai  # optional: use OpenAI for embeddings
# RAG_EMBEDDING_MODEL=text-embedding-3-small

# =============================================================================
# PAYMENT (Stripe)
# =============================================================================
MOTHERSHIP_PAYMENT_DEFAULT_GATEWAY=stripe
STRIPE_ENABLED=false
STRIPE_SECRET_KEY=
STRIPE_WEBHOOK_SECRET=
STRIPE_PUBLISHABLE_KEY=
STRIPE_PRICE_STARTER=
STRIPE_PRICE_PROFESSIONAL=
STRIPE_PRICE_ENTERPRISE=
STRIPE_CUSTOMER_CREATION_ENABLED=true
MOTHERSHIP_PERSISTENCE_MODE=db
MOTHERSHIP_PAYMENT_RECONCILIATION_ENABLED=true
MOTHERSHIP_PAYMENT_RECONCILIATION_INTERVAL=900
MOTHERSHIP_PAYMENT_RECONCILIATION_LOOKBACK_HOURS=168
STRIPE_LIVEMODE_ENFORCEMENT=auto
# Stripe Connect demo placeholders
# TODO: Set these values before using /api/v1/connect-demo endpoints
STRIPE_CONNECT_THIN_WEBHOOK_SECRET=
STRIPE_CONNECT_BILLING_WEBHOOK_SECRET=
STRIPE_CONNECT_SUBSCRIPTION_PRICE_ID=
STRIPE_CONNECT_APPLICATION_FEE_AMOUNT=123
