# Safety Enforcement Pipeline â€” Required Environment Variables
# Copy to .env and fill in values.

# === Redis (required) ===
REDIS_URL=redis://localhost:6379

# === Audit Database (required) ===
# PostgreSQL with asyncpg driver
DATABASE_URL=postgresql+asyncpg://safety:password@localhost:5432/safety_audit

# === Model API (required) ===
MODEL_API_URL=http://localhost:8080/v1/completions
MODEL_API_KEY=
MODEL_NAME=default
MODEL_HTTP_TIMEOUT=60.0

# === Authentication ===
SAFETY_JWT_SECRET=replace-with-a-secure-random-string-at-least-32-chars
# Format: key1:tier1,key2:tier2
SAFETY_API_KEYS=

# === Rate Limiting ===
PRIVILEGED_RATE_LIMIT=100000

# === Notification Channels ===
SLACK_WEBHOOK=https://hooks.slack.com/services/T.../B.../xxx
PAGERDUTY_ROUTING_KEY=

# === Sentry Error Tracking ===
SENTRY_DSN=

# === Detector Configuration ===
SAFETY_EMBEDDING_MODEL=all-MiniLM-L6-v2
SAFETY_CLASSIFIER_PATH=safety/models/safety_classifier.joblib
SAFETY_COSINE_THRESHOLD=0.72
SAFETY_ML_FLAG_THRESHOLD=0.65

# === Sandbox Configuration ===
SAFETY_MAX_TOKENS=4096
SAFETY_MODEL_TIMEOUT=30.0
SAFETY_MODEL_MAX_RPS=10.0

# === Escalation ===
SAFETY_AUTO_SUSPEND_SEVERITY=high
SAFETY_MISUSE_WINDOW=3600
SAFETY_MISUSE_THRESHOLD=5

# === Observability ===
SAFETY_ENV=development
SAFETY_LOG_JSON=true
SAFETY_LOG_LEVEL=INFO
SAFETY_LOG_DIR=safety/logs
SAFETY_DB_ECHO=false

# === Worker Configuration ===
SAFETY_CONSUMER_NAME=worker-1
SAFETY_BATCH_SIZE=5
SAFETY_BLOCK_MS=5000
SAFETY_MAX_RETRIES=3
