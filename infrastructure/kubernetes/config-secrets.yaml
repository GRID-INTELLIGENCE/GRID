apiVersion: v1
kind: Secret
metadata:
  name: grid-secrets
  namespace: grid-{{ .Values.environment }}
type: Opaque
data:
  postgres-user: {{ .Values.database.username | b64enc }}
  postgres-password: {{ .Values.database.password | b64enc }}
  redis-password: {{ .Values.redis.password | b64enc }}
  secret-key: {{ .Values.api.secretKey | b64enc }}

---
apiVersion: v1
kind: ConfigMap
metadata:
  name: grid-config
  namespace: grid-{{ .Values.environment }}
data:
  config.yaml: |
    api:
      port: 8000
      log_level: {{ .Values.api.logLevel }}
      debug: {{ .Values.api.debug }}
    
    database:
      host: {{ .Values.database.host }}
      port: {{ .Values.database.port }}
      name: {{ .Values.database.name }}
      
    redis:
      host: {{ .Values.redis.host }}
      port: {{ .Values.redis.port }}
      db: {{ .Values.redis.db }}

    privacy:
      level: {{ .Values.privacy.level }}

    rate_limiting:
      requests_per_minute: {{ .Values.rateLimiting.requestsPerMinute }}
